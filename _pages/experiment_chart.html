---
layout: archive
title: "GS Performance Chart"
permalink: /experiment-chart/
author_profile: true
redirect_from:
  - /resume
---

{% include base_path %}

<script src="https://cdn.plot.ly/plotly-3.3.0.min.js" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<div id="chart1" class="chart"></div>

<div id="chart2" class="chart"></div>

<div id="chart3" class="chart"></div>

<div id="chart4" class="chart"></div>

<div id="chart5" class="chart"></div>

<div id="chart6" class="chart"></div>

<script>
var sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSgRb1CWKFvn_Yx-AJucuj9uEk9Xblfepoyr2qRcjG8m-mL7mCeNm78Pv0QuMTlVuf6rGFBaPF0bfdD/pub?gid=0&single=true&output=csv';

function formatTime(secs) {
  if (!secs) return 'N/A';
  if (secs >= 3600) {
      return `${Math.floor(secs/3600)}h ${Math.floor((secs%3600)/60)}m ${Math.round(secs%60)}s`;
  }
  if (secs >= 60) {
      return `${Math.floor(secs/60)}m ${Math.round(secs%60)}s`;
  }
  return `${secs}s`;
}

function parseHMS(val) {
  const parts = String(val).split(':').map(Number);
  if (parts.length === 3) {
      return parts[0] * 3600 + parts[1] * 60 + parts[2];
  }
  if (parts.length === 2) {
      return parts[0] * 60 + parts[1];
  }
  return parseFloat(val) || 0;
}

Papa.parse(sheetUrl, {
  download: true,
  header: true,
  complete: function(results) {
    var data = results.data.filter(d => d.method);

    var uniqueMethods = [...new Set(data.map(d => d.method))];
    var palette = ['#4878d0', '#ee854a', '#6acc64', '#d65f5f', '#956cb4', '#8c613c', '#dc7ec0', '#797979', '#d5bb67', '#82c6e2'];
    var colorMap = {};
    uniqueMethods.forEach((m, i) => colorMap[m] = palette[i % palette.length]);

    function lightenColor(hex, factor) {
      var r = parseInt(hex.slice(1, 3), 16);
      var g = parseInt(hex.slice(3, 5), 16);
      var b = parseInt(hex.slice(5, 7), 16);
      r = Math.round(r + (255 - r) * factor);
      g = Math.round(g + (255 - g) * factor);
      b = Math.round(b + (255 - b) * factor);
      return '#' + [r, g, b].map(x => x.toString(16).padStart(2, '0')).join('');
    }

    var colorMapLight = {};
    uniqueMethods.forEach(m => colorMapLight[m] = lightenColor(colorMap[m], 0.5));

    var methods = data.map(d => d.method);
    var gpu = data.map(d => d.gpu);
    
    var times = data.map(d => parseHMS(d.times));
    
    var psnr_7k_train = data.map(d => parseFloat(d.psnr_7k_train) || 0);
    var psnr_7k_test = data.map(d => parseFloat(d.psnr_7k_test) || 0);
    var psnr_30k_train = data.map(d => parseFloat(d.psnr_30k_train) || 0);
    var psnr_30k_test = data.map(d => parseFloat(d.psnr_30k_test) || 0);

    var barStyle = {
      line: {color: '#000', width: 0.5}
    };

    var layout_base = {
      font: {
        family: 'Times New Roman, serif',
        size: 14,
        color: '#000'
      },
      paper_bgcolor: '#fff',
      plot_bgcolor: '#fff',
      margin: {t: 60, b: 80, l: 70, r: 100},
      xaxis: {
        showline: true,
        linewidth: 1.5,
        linecolor: '#000',
        mirror: true,
        ticks: 'outside',
        tickwidth: 1,
        tickcolor: '#000',
        tickfont: {size: 11},
        showgrid: false,
        tickangle: -30
      },
      yaxis: {
        showline: true,
        linewidth: 1.5,
        linecolor: '#000',
        mirror: true,
        ticks: 'outside',
        tickwidth: 1,
        tickcolor: '#000',
        tickfont: {size: 11},
        showgrid: true,
        gridcolor: '#e0e0e0',
        gridwidth: 0.5,
        zeroline: false
      },
      legend: {
        orientation: 'v',
        yanchor: 'middle',
        y: 0.5,
        xanchor: 'left',
        x: 1.02,
        font: {size: 10},
        bordercolor: '#ccc',
        borderwidth: 1,
        bgcolor: 'rgba(255,255,255,0.9)'
      },
      bargap: 0.2,
      bargroupgap: 0.1
    };

    var plotConfig = {
      displayModeBar: false
    };

    var traces1 = [];
    
    uniqueMethods.forEach((method, i) => {
      var row = data.find(d => d.method === method && d.downsampling == 8);
      if (!row) return;
      traces1.push({
        x: [method],
        y: [parseFloat(row.psnr_7k_train) || 0],
        name: i === 0 ? '7k' : '',
        legendgroup: '7k',
        showlegend: i === 0,
        type: 'bar',
        marker: {color: colorMapLight[method], line: barStyle.line},
        offsetgroup: '7k'
      });
      traces1.push({
        x: [method],
        y: [parseFloat(row.psnr_30k_train) || 0],
        name: i === 0 ? '30k' : '',
        legendgroup: '30k',
        showlegend: i === 0,
        type: 'bar',
        marker: {color: colorMap[method], line: barStyle.line},
        offsetgroup: '30k'
      });
    });

    Plotly.newPlot('chart1', traces1, Object.assign({}, layout_base, {
      title: {text: '(a) Training PSNR with Downsampling Factor 8: 7k vs 30k', font: {size: 14}, x: 0.5},
      barmode: 'group',
      xaxis: Object.assign({}, layout_base.xaxis, {}),
      yaxis: Object.assign({}, layout_base.yaxis, {title: {text: 'PSNR (dB)', font: {size: 12}}}),
      legend: Object.assign({}, layout_base.legend, {
        traceorder: 'grouped'
      })
    }), plotConfig);

    var traces2 = [];
    
    uniqueMethods.forEach((method, i) => {
      var row = data.find(d => d.method === method && d.downsampling == 8);
      traces2.push({
        x: [method],
        y: [parseFloat(row.psnr_30k_train) || 0],
        name: i === 0 ? 'Train' : '',
        legendgroup: 'Train',
        showlegend: i === 0,
        type: 'bar',
        marker: {color: colorMap[method], line: barStyle.line},
        offsetgroup: 'Train'
      });
      traces2.push({
        x: [method],
        y: [parseFloat(row.psnr_30k_test) || 0],
        name: i === 0 ? 'Test' : '',
        legendgroup: 'Test',
        showlegend: i === 0,
        type: 'bar',
        marker: {color: colorMapLight[method], line: barStyle.line},
        offsetgroup: 'Test'
      });
    });

    Plotly.newPlot('chart2', traces2, Object.assign({}, layout_base, {
      title: {text: '(b) PSNR with Downsampling Factor 8: Train vs Test (30k)', font: {size: 14}, x: 0.5},
      barmode: 'group',
      xaxis: Object.assign({}, layout_base.xaxis, {}),
      yaxis: Object.assign({}, layout_base.yaxis, {title: {text: 'PSNR (dB)', font: {size: 12}}}),
      legend: Object.assign({}, layout_base.legend, {
        traceorder: 'grouped'
      })
    }), plotConfig);

    Plotly.newPlot('chart4', [{
      x: uniqueMethods,
      y: uniqueMethods.map(m => times[methods.findIndex(x => x === m)]),
      type: 'bar',
      marker: Object.assign({color: uniqueMethods.map(m => colorMap[m])}, barStyle),
      text: uniqueMethods.map(m => gpu[methods.findIndex(x => x === m)]),
      textposition: 'outside',
      textfont: {size: 9, color: '#333'}
    }], Object.assign({}, layout_base, {
      title: {text: '(c) Training Time with Downsampling Factor 8', font: {size: 14}, x: 0.5},
      showlegend: false,
      xaxis: Object.assign({}, layout_base.xaxis, {}),
      yaxis: Object.assign({}, layout_base.yaxis, {title: {text: 'Time (min)', font: {size: 12}}})
    }), plotConfig);

    var uniqueDownsampling = [...new Set(data.map(d => d.downsampling))].sort((a, b) => b - a);

    var traces5 = uniqueMethods.map(method => {
      var yVals = uniqueDownsampling.map(ds => {
        var row = data.find(d => d.method === method && d.downsampling == ds);
        return row ? parseFloat(row.psnr_30k_train) || null : null;
      });
      return {
        x: uniqueDownsampling.map(d => '1/' + d),
        y: yVals,
        name: method,
        type: 'bar',
        marker: Object.assign({color: colorMap[method]}, barStyle)
      };
    });

    Plotly.newPlot('chart5', traces5, Object.assign({}, layout_base, {
      title: {text: '(d) PSNR vs Resolution (30k)', font: {size: 14}, x: 0.5},
      barmode: 'group',
      xaxis: Object.assign({}, layout_base.xaxis, {tickangle: 0}),
      yaxis: Object.assign({}, layout_base.yaxis, {title: {text: 'PSNR (dB)', font: {size: 12}}})
    }), plotConfig);

    var markerShapes = {
      '1': 'circle',
      '2': 'square',
      '4': 'diamond',
      '8': 'cross'
    };

    var traces6 = [];
    
    uniqueMethods.forEach((method, i) => {
      traces6.push({
        x: [null],
        y: [null],
        name: method,
        legendgroup: method,
        type: 'scatter',
        mode: 'markers',
        marker: {
          color: colorMap[method],
          symbol: 'circle',
          size: 10,
          line: {color: '#000', width: 1}
        }
      });
    });
    
    uniqueDownsampling.forEach((ds, i) => {
      traces6.push({
        x: [null],
        y: [null],
        name: '1/' + ds,
        legendgroup: 'factors',
        type: 'scatter',
        mode: 'markers',
        marker: {
          color: '#666',
          symbol: markerShapes[ds] || 'circle',
          size: 10,
          line: {color: '#000', width: 1}
        }
      });
    });
    
    uniqueMethods.forEach(method => {
      uniqueDownsampling.forEach(ds => {
        var methodData = data.filter(d => d.method === method && d.downsampling == ds);
        if (methodData.length === 0) return;
        traces6.push({
          x: methodData.map(d => parseFloat(d.gs_number) || 0),
          y: methodData.map(d => parseFloat(d.psnr_30k_train) || 0),
          legendgroup: method,
          showlegend: false,
          hovertemplate: method + ' (1/' + ds + ')<br>GS: %{x:.3s}<br>PSNR: %{y:.2f} dB<extra></extra>',
          type: 'scatter',
          mode: 'markers',
          marker: {
            color: colorMap[method],
            symbol: markerShapes[ds] || 'circle',
            size: 10,
            line: {color: '#000', width: 1}
          }
        });
      });
    });

    Plotly.newPlot('chart6', traces6, Object.assign({}, layout_base, {
      title: {text: '(e) GS Number vs PSNR (30k)', font: {size: 14}, x: 0.5},
      xaxis: Object.assign({}, layout_base.xaxis, {tickangle: 0}),
      yaxis: Object.assign({}, layout_base.yaxis, {title: {text: 'PSNR (dB)', font: {size: 12}}})
    }), plotConfig);
  }
});
</script>